{
  "year": "2024",
  "question_number": "4",
  "domain": "Putnam",
  "statement": "",
  "solution": [
    {
      "hint_level": 0,
      "content": "The limit equals $\\frac{1-e^{-2}}{2}$.\n\n\\noindent\n\\textbf{First solution.}\nWe first reformulate the problem as a Markov chain.\nLet $v_k$ be the column vector of length $n$ whose $i$-th entry is the probability that $a_{n,k} = i$, so that $v_0$ is the vector $(1,0,\\dots,0)$.\nThen for all $k \\geq 0$, $v_{k+1} = A v_k$ where $A$ is the $n \\times n$\nmatrix defined by\n\\[\nA_{ij} = \\begin{cases}\n\\frac{1}{n} & \\mbox{if $i = j$} \\\\\n\\frac{j-1}{n} & \\mbox{if $i = j-1$} \\\\\n\\frac{n-j}{n} & \\mbox{if $i = j+1$} \\\\\n0 & \\mbox{otherwise.}\n\\end{cases}\n\\]\nLet $w$ be the row vector $(1, \\dots, n)$; then the expected value of $a_{n,k}$ is the sole entry of the $1 \\times 1$ matrix $w v_k = w A^k v_0$. In particular, $E(n) = w A^n v_0$.\n\nWe compute some left eigenvectors of $A$. First,\n\\[\nw_0 := (1,\\dots,1)\n\\]\nsatisfies $Aw_0 = w_0$. Second,\n\\begin{align*}\nw_1 &:= (n-1, n-3, \\dots, 3-n, 1-n) \\\\\n&= (n-2j+1\\colon j=1,\\dots,n)\n\\end{align*}\nsatisfies $Aw_1 = \\frac{n-2}{n} w_1$: the $j$-th entry of $Aw_i$ equals\n\\begin{align*}\n&\\frac{j-1}{n} (n+3-2j) + \\frac{1}{n} (n+1-2j) + \\frac{n-j}{n} (n-1-2j) \\\\\n&\\quad= \\frac{n-2}{n} (n-2j+1).\n\\end{align*}\nBy the same token, we obtain\n\\[\nw = \\frac{n+1}{2} w_0 - \\frac{1}{2} w_1;\n\\]\nwe then have\n\\begin{align*}\n\\frac{E(n)}{n} &= \\frac{n+1}{2n} w_0A^n v_0 - \\frac{1}{2n} w_1A^n v_0 \\\\\n&= \\frac{n+1}{2n} w_0 v_0 - \\frac{1}{2n} \\left( 1 - \\frac{2}{n} \\right)^n w_1 v_0  \\\\\n&= \\frac{n+1}{2n} - \\frac{n-1}{2n} \\left( 1 - \\frac{2}{n} \\right)^n.\n\\end{align*}\nIn the limit, we obtain\n\\begin{align*}\n\\lim_{n \\to \\infty} \\frac{E(n)}{n} &= \\frac{1}{2} - \\frac{1}{2} \\lim_{n \\to \\infty} \\left( 1 - \\frac{2}{n} \\right)^n \\\\\n&= \\frac{1}{2} - \\frac{1}{2} e^{-2}.\n\\end{align*}\n\n\\noindent\n\\textbf{Remark.}\nWith a bit more work, one can show that $A$ has eigenvalues\n$\\frac{n-2j}{n}$ for $j=0,\\dots,n-1$, and find the corresponding left and right eigenvectors.\nIn particular, it is also possible (but much more complicated) to express $v_0$ as a linear combination of right eigenvectors and use this to calculate $A^n v_0$.\n\n\\noindent\n\\textbf{Second solution.} \nWe reinterpret the Markov chain in combinatorial terms.\nConsider an apparatus consisting of one red light bulb, which is initially lit,\nplus $n-1$ white light bulbs, which are initially unlit. \nWe then repeatedly perform the following operation. \nPick one light bulb uniformly at random. If it is the red bulb, do nothing;\notherwise, switch the bulb from lit to unlit or vice versa.\nAfter $k$ operations of this form, the random variable $a_{n,k}$ is equal to the number of lit bulbs (including the red bulb).\n\nWe may then compute the expected value of $a_{n,n}$ by summing over bulbs.\nThe red bulb contributes 1 no matter what. Each other bulb contributes $1$ if it is switched an odd number of times and 0 if it is switched an even number of times,\nor equivalently $\\frac{1}{2}(1-(-1)^j)$ where $j$ is the number of times this bulb is switched.\nHence each bulb other than the red bulb contributes\n\\begin{align*} \n&n^{-n} \\sum_{i=0}^n \\frac{1}{2}(1-(-1)^i) \\binom{n}{i} (n-1)^{n-i} \\\\\n&= \\frac{n^{-n}}{2} \\left( \\sum_{i=0}^n \\binom{n}{i} (n-1)^{n-i} \n- \\sum_{i=0}^n (-1)^i \\binom{n}{i} (n-1)^{n-i} \\right) \\\\\n&= \\frac{n^{-n}}{2} \\left( (1+(n-1))^n - (-1+(n-1))^n \\right) \\\\\n&= \\frac{n^{-n}}{2} (n^2 - (n-2)^n) \\\\\n&= \\frac{1}{2} - \\frac{1}{2} \\left( 1 - \\frac{2}{n} \\right)^n.\n\\end{align*}\nThis tends to $\\frac{1 - e^{-2}}{2}$ as $n \\to \\infty$. Since $E(n)$ equals $n-1$ times this contribution plus 1, $\\frac{E(n)}{n}$ tends to the same limit.\n\n\\noindent\n\\textbf{Third solution.}\nWe compare the effect of taking \n$a_{n,0} = j$ versus $a_{n,0} = j+1$ for some $j \\in \\{1,\\dots,n-1\\}$.\nIf $m_{n,0} \\in \\{j,j+1\\}$ then the values of $a_{n,1}$ coincide, as then do the subsequent values\nof $a_{n,k}$; this occurs with probability $\\frac{2}{n}$. Otherwise, the values of $a_{n,1}$ differ by 1 and the situation repeats.\n\nIterating, we see that the two sequences remain 1 apart (in the same direction) with probability $\\left( \\frac{n-2}{n} \\right)^n$ and converge otherwise. Consequently, changing the start value from $j$ to $j+1$ increases the expected value of $a_{n,n}$ by $\\left( \\frac{n-2}{n} \\right)^n$. \n\nNow let $c$ be the expected value of $a_{n,n}$ in the original setting where $a_{n,0} = 1$.\nBy symmetry, if we started with $a_{n,0} = n$ the expected value would change from $c$ to $n+1-c$;\non the other hand, by the previous paragraph it would increase by \n$(n-1)\\left( \\frac{n-2}{n} \\right)^n$. We deduce that\n\\[\nc = \\frac{1}{2} \\left( n+1 - (n-1) \\left( \\frac{n-2}{n} \\right)^n \\right)\n\\]\nand as above this yields the claimed limit."
    }
  ]
}