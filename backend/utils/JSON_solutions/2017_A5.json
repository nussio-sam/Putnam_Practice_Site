{
  "year": "2017",
  "question_number": "5",
  "domain": "Putnam",
  "statement": "",
  "solution": [
    {
      "hint_level": 0,
      "content": "\\textbf{First solution.}\nLet $a_n, b_n, c_n$ be the probabilities that players $A$, $B$, $C$, respectively, will win the game.\nWe compute these by induction on $n$, starting with the values\n\\[\na_1 = 1, \\qquad b_1 = 0, \\qquad c_1 = 0.\n\\]\nIf player $A$ draws card $k$, then the resulting game state is that of a deck of $k-1$ cards with the players taking turns in the order $B,C,A,B,\\dots$. In this state, the probabilities that players $A, B, C$ will win are\n$c_{k-1}, a_{k-1}, b_{k-1}$ provided that we adopt the convention that\n\\[\na_0 = 0, \\qquad b_0 = 0, \\qquad c_0 = 1.\n\\]\nWe thus have\n\\[\na_n = \\frac{1}{n} \\sum_{k=1}^{n} c_{k-1}, \\quad\nb_n = \\frac{1}{n} \\sum_{k=1}^{n} a_{k-1}, \\quad\nc_n = \\frac{1}{n} \\sum_{k=1}^{n} b_{k-1}.\n\\]\nPut\n\\[\nx_n = a_n - b_n, \\quad y_n = b_n - c_n, \\quad z_n = c_n - a_n;\n\\]\nwe then have\n\\begin{align*}\n x_{n+1} &= \\frac{n}{n+1} x_n + \\frac{1}{n+1}z_n, \\\\\n y_{n+1} &= \\frac{n}{n+1} y_n + \\frac{1}{n+1}x_n, \\\\\n z_{n+1} &= \\frac{n}{n+1} z_n + \\frac{1}{n+1}y_n.\n\\end{align*}\nNote that if $a_{n+1} = b_{n+1} = c_{n+1} = 0$, then\n\\[\nx_n = -nz_n = n^2y_n = -n^3x_n = n^4z_n\n\\]\nand so $x_n = z_n = 0$, or in other words $a_n = b_n = c_n$. By induction on $n$, we deduce that \n$a_n, b_n, c_n$ cannot all be equal. That is, the quantities $x_n, y_n, z_n$ add up to zero and at most one of them\nvanishes; consequently, the quantity $r_n = \\sqrt{x_n^2 + y_n^2 + z_n^2}$ is always positive\nand the quantities\n\\[\nx'_n = \\frac{x_n}{r_n}, \\quad y'_n = \\frac{y_n}{r_n}, \\quad z'_n = \\frac{z_n}{r_n}\n\\]\nform the coordinates of a point $P_n$ on a fixed circle $C$ in $\\mathbb{R}^3$.\n\nLet $P'_n$ be the point $(z_n, x_n, y_n)$ obtained from $P_n$ by a clockwise rotation of angle $\\frac{2\\pi}{3}$.\nThe point $P_{n+1}$ then lies on the ray through the origin passing through the point dividing the chord from $P_n$ to $P'_n$ in the ratio $1:n$. \nThe (clockwise) arc from $P_n$ to $P_{n+1}$ therefore has a measure of\n\\[\n\\arctan \\frac{\\sqrt{3}}{2n-1}\n= \\frac{\\sqrt{3}}{2n-1} + O(n^{-3});\n\\]\nthese measures form a null sequence whose sum diverges. It follows that any arc of $C$ contains infinitely many of the $P_n$; taking a suitably short arc around the point $(\\frac{\\sqrt{2}}{2}, 0, -\\frac{\\sqrt{2}}{2})$, we deduce that for infinitely many $n$, $A$ has the highest winning probability, and similarly for $B$ and $C$.\n\n\\noindent\n\\textbf{Remark:}\nFrom the previous analysis, we also deduce that\n\\[\n\\frac{r_{n+1}}{r_n} = \\frac{\\sqrt{n^2-n+1}}{n+1} = 1 - \\frac{3}{2(n+1)} + O(n^{-2}),\n\\]\nfrom which it follows that $r_n \\sim c n^{-3/2}$ for some $c>0$.\n\n\\noindent\n\\textbf{Second solution.}\n(by Noam Elkies)\nIn this approach, we instead compute the probability $p_n(m)$ that the game ends after exactly $m$ turns\n(the winner being determined by the residue of $m$ mod 3).\nWe use the convention that $p_0(0) = 1$, $p_0(m) = 0$ for $m>0$.\nDefine the generating function $P_n(X) = \\sum_{m=0}^n p_n(m) x^m$.\nWe will establish that\n\\[\nP_n(X) = \\frac{X(X+1)\\cdots(X+n-1)}{n!}\n\\]\n(which may be guessed by computing $p_n(m)$ for small $n$ by hand). There are several ways to do this; for instance,\nthis follows from the recursion\n\\[\nP_n(X) = \\frac{1}{n} X P_{n-1}(X) + \\frac{(n-1)}{n} P_{n-1}(X).\n\\]\n(In this recursion, the first term corresponds to conditional probabilities given that the first card drawn is $n$,\nand the second term corresponds to the remaining cases.)\n\nLet $\\omega$ be a primitive cube root of 1. With notation as in the first solution,\nwe have\n\\[\nP_n(\\omega) = a_n + b_n \\omega + c_n \\omega;\n\\]\ncombining this with the explicit formula for $P_n(X)$ and the observation that\n\\[\n\\mathrm{arg}(w+n) = \\arctan \\frac{\\sqrt{3}}{2n-1}\n\\]\nrecovers the geometric description of $a_n, b_n, c_n$\ngiven in the first solution (as well as the remark following the first solution).\n\n\\noindent\n\\textbf{Third solution.}\nFor this argument, we use the auxiliary quantities\n\\[\na'_n = a_n - \\frac{1}{3}, \\quad b'_n = b_n - \\frac{1}{3}, \\quad c'_n = c_n - \\frac{1}{3};\n\\]\nthese satisfy the relations\n\\[\na'_n = \\frac{1}{n} \\sum_{k=1}^{n} c'_{k-1}, \\quad\nb'_n = \\frac{1}{n} \\sum_{k=1}^{n} a'_{k-1}, \\quad\nc'_n = \\frac{1}{n} \\sum_{k=1}^{n} b'_{k-1}\n\\]\nas well as \n\\begin{align*}\na'_{n+1} &= a'_n + \\frac{1}{n+1} (c'_n-a'_n)  \\\\\nb'_{n+1} &= b'_n + \\frac{1}{n+1} (a'_n-b'_n) \\\\\nc'_{n+1} &= c'_n + \\frac{1}{n+1} (b'_n-c'_n).\n\\end{align*}\nWe now show that $\\sum_{n=1}^\\infty a'_n$ cannot diverge to $+\\infty$\n(and likewise for $\\sum_{n=1}^\\infty b'_n$ and $\\sum_{n=1}^\\infty c'_n$ by similar reasoning).\nSuppose the contrary; then there exists some $\\epsilon > 0$ and some $n_0 > 0$ \nsuch that $\\sum_{k=1}^n a'_k \\geq \\epsilon$ for all $n \\geq n_0$.\nFor $n > n_0$, we have $b'_n \\geq \\epsilon$; this in turn implies that $\\sum_{n=1}^\\infty b'_n$ diverges to $+\\infty$.\nContinuing around the circle, we deduce that for $n$ sufficiently large, all three of $a'_n, b'_n, c'_n$ are positive;\nbut this contradicts the identity $a'_n + b'_n + c'_n = 0$. We thus conclude that $\\sum_{n=1}^\\infty a'_n$ does not diverge to $+\\infty$; in particular, $\\liminf_{n \\to \\infty} a'_n \\leq 0$.\n\nBy the same token, we may see that $\\sum_{n=1}^\\infty a'_n$ cannot converge to a positive limit $L$\n(and likewise for $\\sum_{n=1}^\\infty b'_n$ and $\\sum_{n=1}^\\infty c'_n$ by similar reasoning).\nNamely, this would imply that $b'_n \\geq L/2$ for $n$ sufficiently large, contradicting the previous argument.\n\nBy similar reasoning, $\\sum_{n=1}^\\infty a'_n$ cannot diverge to $-\\infty$ or converge to a negative limit $L$\n(and likewise for $\\sum_{n=1}^\\infty b'_n$ and $\\sum_{n=1}^\\infty c'_n$ by similar reasoning).\n\nWe next establish that there are infinitely many $n$ for which $a'_n > 0$ (and likewise for $b'_n$ and $c'_n$ by similar reasoning).\nSuppose to the contrary that for $n$ sufficiently large, we have $a'_n \\leq 0$. \nBy the previous arguments, the sum $\\sum_{n=1}^\\infty a'_n$ cannot diverge to $\\infty$ or converge to a nonzero limit;\nit must therefore converge to 0. In particular, for $n$ sufficiently large, we have\n$b'_n = \\sum_{k=1}^n a'_{k-1} \\geq 0$. Iterating the construction, we see that for $n$ sufficiently large,\nwe must have $c'_n \\leq 0$, $a'_n \\geq 0$, $b'_n \\leq 0$, and $c'_n \\geq 0$. As a result, for $n$\nsufficiently large we must have $a'_n = b'_n = c'_n = 0$; but we may rule this out as in the original solution.\n\nBy similar reasoning, we may deduce that there are infinitely many $n$ for which $a'_n < 0$ (and likewise for $b'_n$ and $c'_n$ by similar reasoning). We now continue using a suggestion of Jon Atkins.\nDefine the values of the sequence $x_n$ according to the relative comparison of $a'_n, b'_n, c'_n$ (using the fact that these cannot all be equal):\n\\begin{align*}\nx_n = 1: & \\quad a'_n \\leq b'_n < c'_n \\\\\nx_n = 2: & \\quad b'_n \\leq c'_n < a'_n \\\\\nx_n = 3: & \\quad c'_n \\leq a'_n < b'_n \\\\\nx_n = 4: & \\quad a'_n < c'_n \\leq b'_n \\\\\nx_n = 5: & \\quad b'_n < a'_n \\leq c'_n \\\\\nx_n = 6: & \\quad c'_n < b'_n \\leq a'_n.\n\\end{align*}\nWe consider these values as \\emph{states} and say that there is a \\emph{transition} from state $i$ to state $j$,\nand write $i \\Rightarrow j$, if for every $n \\geq 2$ with $x_n = i$ there exists $n' > n$ with $x_{n'} = j$.\n(In all cases when we use this notation, it will in fact be the case that the \\emph{first} value of $n'>n$ for which\n$x_{n'} \\neq i$ satisfes $x_{n'} = j$, but this is not logically necessary for our final conclusion.) \n\nSuppose that $x_n = 1$. By the earlier discussion, we must have $a'_{n'} > 0$ for some $n' > n$, and so we cannot have $x_{n'} = 1$ for all $n' > n$. On the other hand, as long as $x_n = 1$, we have \n\\begin{align*}\nc'_{n+1}-b'_{n+1} &= c'_n - b'_n + \\frac{1}{n+1}(2b'_n  - a'_n - c'_n) \\\\\n&= \\frac{n-1}{n+1} (c'_n - b'_n) + \\frac{1}{n+1}(c'_n - a'_n) > 0 \\\\\nc'_{n+1}-a'_{n+1} &= c'_n - a'_n + \\frac{1}{n+1}(a'_n + b'_n - 2c'_n) \\\\\n&= \\frac{n-1}{n+1} (c'_n - a'_n) + \\frac{1}{n+1}(b'_n - a'_n) > 0.\n\\end{align*}\nConsequently, for $n'$ the smallest value for which $x_{n'} \\neq x_n$, we must have $x_{n'} = 2$. \nBy this and two similar arguments, we deduce that\n\\[\n1 \\Rightarrow 5, \\quad 2 \\Rightarrow 6, \\quad 3 \\Rightarrow 4.\n\\]\nSuppose that $x_n = 4$. By the earlier discussion, we must have $a'_{n'} < 0$ for some $n' > n$, and so we cannot have $x_{n'} = 4$ for all $n' > n$. On the other hand, as long as $x_n = 4$, we have  \n\\begin{align*}\nb'_{n+1}-a'_{n+1} &=b'_n - a'_n + \\frac{1}{n+1} (2a'_n - b'_n - c'_n) \\\\\n&= \\frac{n-1}{n+1} (b'_n - a'_n) + \\frac{1}{n+1}(b'_n - c'_n) > 0 \\\\\nc'_{n+1}-a'_{n+1} &= c'_n - a'_n + \\frac{1}{n+1}(a'_n + b'_n - 2c'_n) \\\\\n&= \\frac{n-1}{n+1} (c'_n - a'_n) + \\frac{1}{n+1}(b'_n - a'_n) > 0.\n\\end{align*}\nConsequently, for $n'$ the smallest value for which $x_{n'} \\neq x_n$, we must have $x_{n'} = 1$. \nBy this and two similar arguments, we deduce that\n\\[\n4 \\Rightarrow 1, \\quad 5 \\Rightarrow 2, \\quad 6 \\Rightarrow 3.\n\\]\nCombining, we obtain\n\\[\n1 \\Rightarrow 5 \\Rightarrow 2 \\Rightarrow 6 \\Rightarrow 3 \\Rightarrow 4 \\Rightarrow 1\n\\]\nand hence the desired result."
    }
  ]
}