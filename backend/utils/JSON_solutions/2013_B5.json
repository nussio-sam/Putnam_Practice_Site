{
  "year": "2013",
  "question_number": "5",
  "domain": "Putnam",
  "statement": "",
  "solution": [
    {
      "hint_level": 0,
      "content": "\\setcounter{lemma}{0}\n\\textbf{First solution:}\nWe assume $n \\geq 1$ unless otherwise specified.\nFor $T$ a set and $S_1, S_2$ two subsets of $T$, we say that a function $f: T \\to T$ \\emph{iterates $S_1$ into $S_2$} if for each $x \\in S_1$, there is a $j \\geq 0$ such that $f^{(j)}(x) \\in S_2$.\n\n\\begin{lemma}\nFix $k \\in X$. Let $f,g: X \\to X$ be two functions such that $f$ iterates $X$ into $\\{1,\\dots,k\\}$ and $f(x) = g(x)$ for $x \\in \\{k+1,\\dots,n\\}$. Then $g$ also iterates $X$ into $\\{1,\\dots,k\\}$.\n\\end{lemma}\n\\begin{proof}\nFor $x \\in X$, by hypothesis there exists a nonnegative integer $j$ such that $f^{(j)}(x) \\in \\{1,\\dots,k\\}$. Choose the integer $j$ as small as possible; then $f^{(i)}(x) \\in \\{k+1,\\dots,n\\}$ for $0 \\leq i<j$. By induction on $i$, we have $f^{(i)}(x) = g^{(i)}(x)$ for $i=0,\\dots,j$, so in particular $g^{(j)}(x) \\in \\{1,\\dots,k\\}$. This proves the claim.\n\\end{proof}\n\nWe proceed by induction on $n-k$, the case $n-k=0$ being trivial.\nFor the induction step, we need only confirm that the number $x$ of functions $f: X \\to X$ which iterate $X$ into $\\{1,\\dots,k+1\\}$ but not into $\\{1,\\dots,k\\}$ is equal to $n^{n-1}$. These are precisely the functions for which there is a unique cycle $C$ containing only numbers in $\\{k+1,\\dots,n\\}$ and said cycle contains $k+1$. Suppose $C$ has length $\\ell \\in \\{1,\\dots,n-k\\}$. For a fixed choice of $\\ell$, we may choose the underlying set of $C$ in\n$\\binom{n-k-1}{\\ell-1}$ ways and the cycle structure in $(\\ell-1)!$ ways. Given $C$, the functions $f$ we want are the ones that act on $C$ as specified and iterate $X$ into\n$\\{1,\\dots,k\\} \\cup C$.\nBy Lemma~1, the number of such functions is\n$n^{-\\ell}$ times the total number of functions that iterate $X$ into\n$\\{1,\\dots,k\\} \\cup C$.\nBy the induction hypothesis,\nwe compute the number of functions  which iterate $X$ into $\\{1,\\dots,k+1\\}$ but not into $\\{1,\\dots,k\\}$ to be\n\\[\n\\sum_{\\ell=1}^{n-k} (n-k-1)\\cdots(n-k-\\ell+1)\n(k+\\ell) n^{n-\\ell-1}\n\\]\nBy rewriting this as a telescoping sum, we get\n\\begin{align*}\n&\\sum_{\\ell=1}^{n-k} (n-k-1)\\cdots(n-k-\\ell+1)\n(n) n^{n-\\ell-1} \\\\\n&- \\sum_{\\ell=1}^{n-k} (n-k-1)\\cdots(n-k-\\ell+1)\n(n-k-\\ell) n^{n-\\ell-1} \\\\\n&=\\sum_{\\ell=0}^{n-k-1} (n-k-1)\\cdots(n-k-\\ell) n^{n-\\ell-1} \\\\\n&- \\sum_{\\ell=1}^{n-k} (n-k-1)\\cdots\n(n-k-\\ell) n^{n-\\ell-1} \\\\\n&= n^{n-1}.\n\\end{align*}\nas desired.\n\n\\textbf{Second solution:}\nFor $T$ a set, $f: T \\to T$ a function, and $S$ a subset of $T$,\nwe define the \\emph{contraction} of $f$ at $S$ as the function $g: \\{* \\} \\cup (T-S) \\to \\{*\\}  \\cup (T-S)$\ngiven by\n\\[\ng(x) = \\begin{cases} * & x = *  \\\\\n* & x \\neq *, f(x) \\in S \\\\\nf(x) & x \\neq *, f(x) \\notin S.\n\\end{cases}\n\\]\n\\begin{lemma}\nFor $S \\subseteq X$ of cardinality $\\ell \\geq 0$,\nthere are $\\ell n^{n-\\ell-1}$ functions $f: \\{*\\} \\cup X \\to \\{*\\} \\cup X$ with $f^{-1}(*) = \\{*\\} \\cup S$\nwhich iterate $X$ into $\\{*\\}$.\n\\end{lemma}\n\\begin{proof}\nWe induct on $n$. If $\\ell = n$ then there is nothing to check.\nOtherwise, put $T = f^{-1}(S)$, which must be nonempty.\nThe contraction $g$ of $f$ at $\\{*\\} \\cup S$ is then a function on $\\{*\\} \\cup (X-S)$ with $f^{-1}(*) = \\{*\\} \\cup T$ which iterates $X-S$ into $\\{*\\}$. Moreover, for given $T$, each such $g$ arises from\n$\\ell^{\\# T}$ functions of the desired form.\nSumming over $T$ and invoking the induction hypothesis, we see that the number of functions $f$ is \n\\begin{align*}\n&\\sum_{k=1}^{n-\\ell} \\binom{n-\\ell}{k} \\ell^k \\cdot k (n-\\ell)^{n-\\ell-k-1} \\\\\n&=\\sum_{k=1}^{n-\\ell} \\binom{n-\\ell-1}{k-1} \\ell^k (n-\\ell)^{n-\\ell-k} \n= \\ell n^{n-\\ell-1}\n\\end{align*}\nas claimed.\n\\end{proof}\n\nWe now count functions $f: X \\to X$ which iterate $X$ into $\\{1,\\dots,k\\}$ as follows. By Lemma~1 of the first solution, this count equals $n^k$ times the number of functions with $f(1) = \\cdots = f(k) = 1$  which iterate $X$ into $\\{1,\\dots,k\\}$. For such a function $f$, put $S = \\{k+1,\\dots,n\\} \\cap f^{-1}(\\{1,\\dots,k\\})$ and let $g$ be the contraction of $f$\nat $\\{1,\\dots,k\\}$; then $g^{-1}(*) = * \\cup \\{S\\}$ and $g$ iterates \nits domain into $*$. By Lemma~2, for $\\ell = \\#S$, there are\n$\\ell (n-k)^{n-k-\\ell-1}$ such functions $g$.\nFor given $S$, each such $g$ gives rise to $k^{\\ell}$ functions $f$ with $f(1) = \\cdots = f(k) = 1$  which iterate $X$ into $\\{1,\\dots,k\\}$.\nThus the number of such functions $f$ is\n\\begin{align*}\n&\\sum_{\\ell=0}^{n-k} \\binom{n-k}{\\ell} k^{\\ell} \\ell (n-k)^{n-k-\\ell-1} \\\\\n&= \\sum_{\\ell=0}^{n-k} \\binom{n-k-1}{\\ell-1} k^{\\ell} (n-k)^{n-k-\\ell}\\\\\n&= k n^{n-k-1}.\n\\end{align*}\nThe desired count is this times $n^k$, or $k n^{n-1}$ as desired.\n\n\\textbf{Remark:}\nFunctions of the sort counted in Lemma~2 can be identified with rooted trees on the vertex set $\\{*\\} \\cup X$ with root $*$. Such trees can be counted using \\emph{Cayley's formula}, a special case of \\emph{Kirchoff's matrix tree theorem}. The matrix tree theorem can also be used to show directly that the number of rooted forests on $n$ vertices with $k$ fixed roots is $k n^{n-k-1}$; the desired count follows immediately from this formula plus Lemma~1. (One can also use Pr\\\"ufer sequences for a more combinatorial interpretation.)"
    }
  ]
}