{
  "year": "2011",
  "question_number": "6",
  "domain": "Putnam",
  "statement": "",
  "solution": [
    {
      "hint_level": 0,
      "content": "In order to interpret the problem statement, one must choose a convention for the value of $0^0$; we will take\nit to equal 1. (If one takes $0^0$ to be 0, then the problem fails for $p=3$.)\n\n\\textbf{First solution.}\nBy Wilson's theorem,\n\\[\nk! (p-1-k)! \\equiv (-1)^{k} (p-1)! \\equiv (-1)^{k+1} \\pmod{p},\n\\]\nso we have a congruence of Laurent polynomials\n\\begin{align*}\n\\sum_{k=0}^{p-1} k! x^k &\\equiv \\sum_{k=0}^{p-1} \\frac{(-1)^{k+1} x^k}{(p-1-k)!} \\pmod{p} \\\\\n&\\equiv -x^{p-1} \\sum_{k=0}^{p-1} \\frac{(-x)^{-k}}{k!} \\pmod{p}.\n\\end{align*}\nReplacing $x$ with $-1/x$, we reduce the original problem to showing that the polynomial\n\\[\ng(x) = \\sum_{k=0}^{p-1} \\frac{x^k}{k!}\n\\]\nover $\\FF_p$ has at most $(p-1)/2$ nonzero roots in $\\FF_p$. To see this, write\n\\[\nh(x) = x^p - x + g(x)\n\\]\nand note that by Wilson's theorem again,\n\\[\nh'(x) = 1 + \\sum_{k=1}^{p-1} \\frac{x^{k-1}}{(k-1)!} = x^{p-1} - 1 + g(x).\n\\]\nIf $z \\in \\FF_p$ is such that $g(z) = 0$, then $z \\neq 0$ because $g(0) = 1$.\nTherefore, $z^{p-1} = 1$, so $h(z) = h'(z) = 0$ and so $z$ is at least a double root of $h$.\nSince $h$ is a polynomial of degree $p$, there can be at most $(p-1)/2$ zeroes of $g$ in $\\FF_p$, as desired.\n\n\\noindent\n\\textbf{Second solution.} (By Noam Elkies)\nDefine the polynomial $f$ over $\\FF_p$ by\n\\[\nf(x) = \\sum_{k=0}^{p-1} k! x^k.\n\\]\nPut $t = (p-1)/2$; the problem statement is that $f$\nhas at most $t$ roots modulo $p$.\nSuppose the contrary; since $f(0) = 1$,\nthis means that $f(x)$ is nonzero for at most $t-1$ values of $x \\in \\FF_p^*$.\nDenote these values by $x_1,\\dots,x_m$, where by assumption $m < t$, and define the polynomial\n$Q$ over $\\FF_p$ by\n\\[\nQ(x) =\n\\prod_{k=1}^m (x - x_m) = \\sum_{k=0}^{t-1} Q_k x^k.\n\\]\nThen we can write\n\\[\nf(x) = \\frac{P(x)}{Q(x)} (1-x^{p-1})\n\\]\nwhere $P(x)$ is some polynomial of degree at most $m$.\nThis means that the power series expansions of $f(x)$ and $P(x)/Q(x)$ coincide modulo $x^{p-1}$,\nso the coefficients of $x^t, \\dots, x^{2t-1}$ in $f(x) Q(x)$ vanish.\nIn other words, the product of the square matrix\n\\[\nA = ((i+j+1)!)_{i,j=0}^{t-1}\n\\]\nwith the nonzero column vector $(Q_{t-1}, \\dots, Q_0)$ is zero.\nHowever, by the following lemma, $\\det(A)$ is nonzero modulo $p$, a contradiction.\n\n\\begin{lemma}\nFor any nonnegative integer $m$ and any integer $n$,\n\\[\n\\det((i+j+n)!)_{i,j=0}^m = \\prod_{k=0}^m k! (k+n)!.\n\\]\n\\end{lemma}\n\\begin{proof}\nDefine the $(m+1) \\times (m+1)$ matrix $A_{m,n}$ by $(A_{m,n})_{i,j} = \\binom{i+j+n}{i}$;\nthe desired result is then that $\\det(A_{m,n}) = 1$. Note that\n\\[\n(A_{m,n-1})_{ij} = \\begin{cases}\n(A_{m,n})_{ij} & i=0 \\\\\n(A_{m,n})_{ij} - (A_{m,n})_{(i-1)j} & i > 0;\n\\end{cases}\n\\]\nthat is, $A_{m,n-1}$ can be obtained from $A_{m,n}$ by elementary row operations.\nTherefore, $\\det(A_{m,n}) = \\det(A_{m,n-1})$, so $\\det(A_{m,n})$ depends only on $m$.\nThe claim now follows by observing that $A_{0,0}$ is the $1 \\times 1$ matrix with entry 1\nand that $A_{m,-1}$ has the block representation $\\begin{pmatrix} 1 & * \\\\ 0 & A_{m-1,0} \\end{pmatrix}$.\n\\end{proof}\n\n\\noindent\n\\textbf{Remark.}\nElkies has given a more detailed discussion of the origins of this solution in the theory of orthogonal\npolynomials; see \\texttt{http://mathoverflow.net/questions/82648}."
    }
  ]
}