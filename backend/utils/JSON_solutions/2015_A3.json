{
  "year": "2015",
  "question_number": "3",
  "domain": "Putnam",
  "statement": "",
  "solution": [
    {
      "hint_level": 0,
      "content": "The answer is $13725$.\nWe first claim that if $n$ is odd, then $\\prod_{b=1}^{n} (1+e^{2\\pi i ab/n}) = 2^{\\gcd(a,n)}$. To see this, write $d = \\gcd(a,n)$ and $a = da_1$, $n=dn_1$ with $\\gcd(a_1,n_1) = 1$. Then\n$a_1, 2a_1,\\dots,n_1 a_1$ modulo $n_1$ is a permutation of $1,2,\\dots,n_1$ modulo $n_1$, and so $\\omega^{a_1},\\omega^{2a_1},\\dots,\\omega^{n_1 a_1}$ is a permutation of $\\omega,\\omega^2,\\ldots,\\omega^{n_1}$;  it follows that for $\\omega = e^{2\\pi i/n_1}$,\n\\[\n\\prod_{b=1}^{n_1} (1+e^{2\\pi i a b/n}) =\n\\prod_{b=1}^{n_1} (1+e^{2\\pi i a_1 b/n_1}) = \\prod_{b=1}^{n_1} (1+\\omega^b).\n\\]\nNow since the roots of $z^{n_1}-1$ are $\\omega,\\omega^2,\\ldots,\\omega^{n_1}$, it follows that\n$z^{n_1}-1 = \\prod_{b=1}^{n_1} (z-\\omega^b)$. Setting $z=-1$ and using the fact that $n_1$ is odd gives $\\prod_{b=1}^{n_1} (1+\\omega^b) = 2$. \n\nFinally,\n$\\prod_{b=1}^{n} (1+e^{2\\pi i ab/n}) = (\\prod_{b=1}^{n_1} (1+e^{2\\pi i ab/n}))^d = 2^d$, and we have proven the claim.\n\nFrom the claim, we find that\n\\begin{align*}\n&\\log_2 \\left( \\prod_{a=1}^{2015} \\prod_{b=1}^{2015} (1+e^{2\\pi i a b/2015}) \\right) \\\\\n&= \\sum_{a=1}^{2015} \\log_2 \\left(\\prod_{b=1}^{2015} (1+e^{2\\pi i a b/2015}) \\right) \\\\\n&= \\sum_{a=1}^{2015} \\gcd(a,2015).\n\\end{align*}\nNow for each divisor $d$ of $2015$, there are $\\phi(2015/d)$ integers between $1$ and $2015$ inclusive whose $\\gcd$ with $2015$ is $d$. Thus\n\\[\n\\sum_{a=1}^{2015} \\gcd(a,2015) = \\sum_{d|2015} d\\cdot \\phi(2015/d).\n\\]\nWe factor $2015 = pqr$ with $p=5$, $q=13$, and $r=31$, and calculate\n\\begin{align*}\n&\\sum_{d|pqr} d\\cdot \\phi(pqr/d) \\\\\n&= 1 \\cdot (p-1)(q-1)(r-1) + p \\cdot (q-1)(r-1) \\\\\n&\\quad + q\\cdot (p-1)(r-1) + r\\cdot (p-1)(q-1) + pq \\cdot (r-1) \\\\\n& \\quad + pr\\cdot (q-1) + qr\\cdot (p-1) + pqr \\cdot 1 \\\\\n&\\quad = (2p-1)(2q-1)(2r-1).\n\\end{align*}\nWhen $(p,q,r) = (5,13,31)$, this is equal to $13725$.\n\n\\noindent\n\\textbf{Remark:}\nNoam Elkies suggests the following similar but shorter derivation of the equality\n$\\prod_{b=1}^{n_1} (1 + \\omega^b) = 2$: write\n\\[\n\\prod_{b=1}^{n_1-1} (1 + \\omega^b) = \\frac{\\prod_{b=1}^{n_1 - 1} (1 - \\omega^{2b})}{\\prod_{b=1}^{n_1-1} (1 - \\omega^b)}\n\\]\nand note (as above) that $\\omega^2, \\omega^{4}, \\dots, \\omega^{2(n_1-1)}$ is a permutation of $\\omega, \\dots, \\omega^{n_1-1}$, so the two products in the fraction are equal.\n\n\\noindent\n\\textbf{Remark:}\nThe function $f(n) = \\sum_{d|n} d\\cdot \\phi(n/d)$ is multiplicative: for any two coprime positive integers $m,n$, we have $f(mn) = f(m) f(n)$. This follows from the fact that $f(n)$ is the convolution of the two multiplicative functions $n \\mapsto n$ and $n \\mapsto \\phi(n)$; it can also be seen directly using the Chinese remainder theorem."
    }
  ]
}