{
  "year": "2012",
  "question_number": "6",
  "domain": "Putnam",
  "statement": "",
  "solution": [
    {
      "hint_level": 0,
      "content": "\\textbf{First solution.}\nSince fixed points do not affect the signature of a permutation, we may\nignore the residue class of $0$ and consider $\\pi$ as a permutation on the\nnonzero residue classes modulo $p$. These form a cyclic group of order $p-1$,\nso the signature of $\\pi$ is also the signature of multiplication by 3 as\na permutation $\\sigma$ of the residue classes modulo $p-1$. If we identify\nthese classes with the integers $0,\\dots,p-2$, then the signature equals\nthe parity of the number of \\emph{inversions}: these are the pairs $(i,j)$\nwith $0 \\leq i < j \\leq p-2$ for which $\\sigma(i) > \\sigma(j)$. We may write\n\\[\n\\sigma(i) = 3i - (p-1) \\left\\lfloor \\frac{3i}{p-1} \\right\\rfloor\n\\]\nfrom which we see that $(i,j)$ cannot be an inversion unless $\\lfloor \\frac{3j}{p-1} \\rfloor > \\lfloor \\frac{3i}{p-1} \\rfloor$. In particular, we only obtain inversions when $i < 2(p-1)/3$.\n\nIf $i < (p-1)/3$, the elements $j$ of $\\{0,\\dots,p-2\\}$ for which $(i,j)$ is an inversion correspond to the elements of $\\{0,\\dots,3i\\}$ which are not multiples of $3$, which are $2i$ in number.\nThis contributes a total of $0 + 2 + \\cdots + 2(p-2)/3 = (p-2)(p+1)/9$ inversions.\n\nIf $(p-1)/3 < i < 2(p-1)/3$, the elements $j$ of $\\{0,\\dots,p-2\\}$ for which $(i,j)$ is an inversion correspond\nto the elements of $\\{0, \\dots, 3i-p+1\\}$ congruent to 1 modulo 3, which are\n$(3i-p+2)/3 = i - (p-2)/3$ in number. This contributes a total of\n$1 + \\cdots + (p-2)/3 = (p-2)(p+1)/18$ inversions.\n\nSumming up, the total number of inversions is $(p-2)(p+1)/6$, which is even if and only if\n$p \\equiv 3 \\pmod{4}$. This proves the claim.\n\n\\noindent\n\\textbf{Second solution} (by Noam Elkies).\nRecall that the sign of $\\pi$ (which is $+1$ if $\\pi$ is even and $-1$ if $\\pi$ is odd)\ncan be computed as\n\\[\n\\prod_{0 \\leq x < y < p} \\frac{\\pi(x) - \\pi(y)}{x - y}\n\\]\n(because composing $\\pi$ with a transposition changes the sign of the product).\nReducing modulo $p$, we get a congruence with\n\\[\n\\prod_{0 \\leq x < y < p} \\frac{x^3-y^3}{x-y} = \\prod_{0 \\leq x < y < p} (x^2 + xy + y^2).\n\\]\nIt thus suffices to count the number of times each possible value of $x^2+xy+y^2$ occurs.\nEach nonzero value $c$ modulo $p$ occurs $p+1$ times as $x^2+xy+y^2$ with $0 \\leq x, y < p$\nand hence $(p + \\chi(c/3))/2$ times with $0 \\leq x < y < p$, where $\\chi$ denotes the quadratic character\nmodulo $p$. Since $p \\equiv 2 \\pmod{3}$, by the law of quadratic reciprocity we have\n$\\chi(-3) = +1$, so $\\chi(c/3) = \\chi(-c)$.\nIt thus remains to evaluate the product $\\prod_{c=1}^{p-1} c^{(p+\\chi(-c))/2}$ modulo $p$.\n\nIf $p \\equiv 3 \\pmod{4}$, this is easy: each factor is a quadratic residue (this is clear if $c$ is a residue,\nand otherwise $\\chi(-c) = +1$ so $p+\\chi(-c)$ is divisible by $4$) and $-1$ is not, so we must get $+1$\nmodulo $p$.\n\nIf $p \\equiv 1 \\pmod{4}$, we must do more work: we\nchoose a primitive root $g$ modulo $p$ and rewrite the product as\n\\[\n\\prod_{i=0}^{p-2} g^{i(p+(-1)^i)/2}.\n\\]\nThe sum of the exponents, split into sums over $i$ odd and $i$ even, gives\n\\[\n\\sum_{j=0}^{(p-3)/2} \\left( j(p+1) + \\frac{(2j+1)(p-1)}{2}\\right)\n\\]\nwhich simplifies to\n\\[\n\\frac{(p-3)(p-1)(p+1)}{8} + \\frac{(p-1)^3}{8} = \\frac{p-1}{2} \\left( \\frac{p^2 - 1}{2} - p \\right).\n\\]\nHence the product we are trying to evaluate is congruent to $g^{(p-1)/2} \\equiv -1$ modulo $p$.\n\n\\noindent\n\\textbf{Third solution} (by Mark van Hoeij).\nWe compute the parity of $\\pi$ as the parity of the number of cycles of even length\nin the cycle decomposition of $\\pi$.\nFor $x$ a nonzero residue class modulo $p$ of multiplicative order $d$, the elements of the orbit of $x$\nunder $\\pi$ also have order $d$ (because $d$ divides $p-1$ and hence is coprime to $3$). Since the group\nof nonzero residue classes modulo $p$ is cyclic of order $p-1$, the elements of order $d$ fall into\n$\\varphi(d)/f(d)$ orbits under $\\pi$, where $\\varphi$ is the Euler phi function and $f(d)$ is the\nmultiplicative order of 3 modulo $d$. The parity of $\\pi$ is then the parity of the sum of $\\varphi(d)/f(d)$\nover all divisors $d$ of $p-1$ for which $f(d)$ is even.\n\nIf $d$ is odd, then $\\varphi(d)/f(d) = \\varphi(2d)/f(2d)$, so the summands corresponding to $d$ and $2d$\ncoincide. It thus suffices to consider those $d$ divisible by $4$. If $p \\equiv 3 \\pmod{4}$, then there are no\nsuch summands, so the sum is trivially even.\n\nIf $p \\equiv 1 \\pmod{4}$, then $d=4$ contributes a summand of $\\varphi(4)/f(4) = 2/2 = 1$.\nFor each $d$ which is a larger multiple of 4, the group $(\\ZZ/d\\ZZ)^*$ is isomorphic to the product of\n$\\ZZ/2\\ZZ$ with another group of even order, so the maximal power of 2 dividing $f(d)$ is strictly smaller\nthan the maximal power of 2 dividing $d$. Hence $\\varphi(d)/f(d)$ is even, and so the overall sum is odd.\n\n\\noindent\n\\textbf{Remark.}\nNote that the second proof uses quadratic reciprocity, whereas the first and third proofs are similar to several classical\nproofs of quadratic reciprocity. Abhinav Kumar notes that the problem itself is a special case\nof the Duke-Hopkins quadratic reciprocity law for abelian groups (Quadratic reciprocity in a finite group,\n\\textit{Amer. Math. Monthly} \\textbf{112} (2005), 251--256; see also\n\\url{http://math.uga.edu/~pete/morequadrec.pdf})."
    }
  ]
}