{
  "year": "2015",
  "question_number": "6",
  "domain": "Putnam",
  "statement": "",
  "solution": [
    {
      "hint_level": 0,
      "content": "\\textbf{First solution:}\n(by Noam Elkies)\nUsing row and column operations, we may construct invertible matrices $U,V$ such that\n$U^{-1} M V$ is a block diagonal matrix of the form\n\\[\n\\begin{pmatrix} I & 0 \\\\ 0 & 0 \\end{pmatrix}.\n\\]\nPut $A' = U^{-1} A U, M' = U^{-1} M V, B' = V^{-1} B V$, $X' = V^{-1} X U$,\nso that $A' M' = M' B'$,\n$\\det(A-MX) = \\det(U^{-1}(A-MX)U) = \\det(A' - M'X')$,\nand\n$\\det(B-XM) = \\det(V^{-1}(B-XM)V) = \\det(B' - X'M')$.\nForm the corresponding block decompositions\n\\[\nA' = \\begin{pmatrix} A_{11} & A_{12} \\\\ A_{21} & A_{22} \\end{pmatrix},\nB' = \\begin{pmatrix} B_{11} & B_{12} \\\\ B_{21} & B_{22} \\end{pmatrix},\nX' = \\begin{pmatrix} X_{11} & X_{12} \\\\ X_{21} & X_{22} \\end{pmatrix}.\n\\]\nWe then have\n\\[\nA' M' = \\begin{pmatrix} A_{11} & 0 \\\\ A_{21} & 0 \\end{pmatrix}, \\qquad\nM' B' = \\begin{pmatrix} B_{11} & B_{12} \\\\ 0 & 0 \\end{pmatrix},\n\\]\nso we must have $A_{11} = B_{11}$ and $A_{21} = B_{12} = 0$;\nin particular, the characteristic polynomial of $A$ is the product of the characteristic polynomials of $A_{11}$ and $A_{22}$, and the characteristic polynomial of $B$ is the product of the characteristic polynomials of $B_{11}$ and $B_{22}$. Since $A_{11} = B_{11}$, it follows that $A_{22}$ and $B_{22}$ have the same characteristic polynomial.\nSince\n\\[\nX' M' = \\begin{pmatrix} X_{11} & 0 \\\\ X_{21} & 0 \\end{pmatrix}, \\qquad\nM' X' = \\begin{pmatrix} X_{11} & X_{12} \\\\ 0 & 0 \\end{pmatrix},\n\\]\nwe conclude that\n\\begin{align*}\n\\det(A-MX) &= \\det(A'-M'X') \\\\\n&= \\det \\begin{pmatrix} A_{11}-X_{11} & A_{12} - X_{12} \\\\ 0 & A_{22} \\end{pmatrix} \\\\\n&= \\det(A_{11}-X_{11}) \\det(A_{22}) \\\\\n&= \\det(B_{11}-X_{11}) \\det(B_{22}) \\\\\n&= \\det \\begin{pmatrix} B_{11}-X_{11} & 0 \\\\ B_{21}-X_{21} & B_{22} \\end{pmatrix} \\\\\n&= \\det(B'-X'M') \\\\\n&= \\det(B-XM),\n\\end{align*}\nas desired. (By similar arguments, $A-MX$ and $B-XM$ have the same characteristic polynomial.)\n\n\\noindent\n\\textbf{Second solution:}\nWe prove directly that $A-MX$ and $B-XM$ have the same characteristic polynomial, i.e., for any $t \\in \\mathbb{R}$, writing $A_t = A-tI$, $B_t = B-tI$, we have\n\\[\n\\det(A_t - MX) = \\det(B_t - XM).\n\\]\nFor fixed $A,B,M$, the stated result is a polynomial identity in $t$ and the entries of $X$. It thus suffices to check it assuming that $A_t,B_t, X$ are all invertible.\nSince $AM = MB$, we also have $A_t M = M B_t$, so $A_tMB_t^{-1} = M$.\nSince $\\det(A_t) = \\det(B_t)$ by hypothesis,\n\\begin{align*}\n\\det(A_t - MX) &= \\det (A_t - A_tM B_t^{-1} X)\\\\\n&= \\det(A_t) \\det(1 - M B_t^{-1} X) \\\\\n&= \\det(A_t) \\det(X) \\det(B_t)^{-1} \\det(X^{-1} B_t - M) \\\\\n&= \\det(X) \\det(X^{-1} B_t - M) \\\\\n&= \\det(B_t - XM).\n\\end{align*}\n\n\\noindent\n\\textbf{Remark:}\nOne can also assert directly that\n$\\det(1 - M B_t^{-1} X) = \\det(1 - X M B_t^{-1})$ using the fact that for any square matrices $U$ and $V$, $UV$ and $VU$ have the same characteristic polynomial; \nthe latter is again proved by reducing to the case where one of the two matrices is invertible, in which case the two matrices are similar.\n\n\\noindent\n\\textbf{Third solution:}\n(by Lev Borisov)\nWe will check that for each positive integer $k$,\n\\[\n\\Trace((A-MX)^k) = \\Trace((B- XM)^k).\n\\]\nThis will imply that $A-MX$ and $B-XM$ have the same characteristic polynomial, yielding the desired result.\n\nWe establish the claim by expanding both sides and comparing individual terms.\nBy hypothesis, $A^k$ and $B^k$ have the same characteristic polynomial, so\n$\\Trace(A^k) = \\Trace(B^k)$. \nTo compare the other terms, it suffices to check that for any sequence $i_1, i_2,\\dots, i_m$ of nonnegative integers,\n\\begin{align*}\n& \\Trace(A^{i_1} MX A^{i_2} MX \\cdots A^{i_{m-1}} MX A^{i_m})\\\\\n&\\quad =\n\\Trace(B^{i_1} XM B^{i_2} XM \\cdots B^{i_{m-1}} XM B^{i_m}).\n\\end{align*}\nTo establish this equality, first apply the remark following the previous solution to write\n\\begin{align*}\n& \\Trace(A^{i_1} MX A^{i_2} MX \\cdots A^{i_{m-1}} MX A^{i_m})\\\\\n&\\quad =\n\\Trace(A^{i_m + i_1} MX A^{i_2} MX \\cdots A^{i_{m-1}} MX).\n\\end{align*}\nThen apply the relation $AM = MB$ repeatedly to commute $M$ past $A$, to obtain\n\\[\n\\Trace(M B^{i_m + i_1} X M B^{i_2} XM \\cdots XM B^{i_{m-1}} X).\n\\]\nFinally, apply the remark again to shift $MB^{i_m}$ from the left end to the right end.\n\n\\noindent\n\\textbf{Remark:}\nThe conclusion holds with $\\RR$ replaced by an arbitrary field.\nIn the second solution, one must reduce to the case of an infinite field, e.g., by replacing the original field with an algebraic closure. The third solution only applies to fields of characteristic 0 or positive characteristic greater than $n$.\n\n\\noindent\n\\textbf{Remark:}\nIt is tempting to try to reduce to the case where $M$ is invertible, as in this case $A-MX$ and $B-XM$ are in fact similar. However, it is not clear how to make such an argument work."
    }
  ]
}