{
  "year": "2008",
  "question_number": "6",
  "domain": "Putnam",
  "statement": "",
  "solution": [
    {
      "hint_level": 0,
      "content": "In all solutions,\nlet $F_{n,k}$ be the number of $k$-limited permutations of\n$\\{1,\\dots,n\\}$.\n\n\\textbf{First solution:}\n(by Jacob Tsimerman)\nNote that any permutation is $k$-limited if and only if its inverse is\n$k$-limited. Consequently, the number of $k$-limited permutations of\n$\\{1,\\dots,n\\}$ is the same as the number of $k$-limited involutions\n(permutations equal to their inverses) of $\\{1,\\dots,n\\}$.\n\nWe use the following fact several times: the number of involutions\nof $\\{1,\\dots,n\\}$ is odd if $n=0,1$ and even otherwise. This follows from\nthe fact that non-involutions come in pairs, so the number of involutions\nhas the same parity as the number of permutations, namely $n!$.\n\nFor $n \\leq k+1$, all involutions are $k$-limited.\nBy the previous paragraph, $F_{n,k}$ is odd for $n=0,1$ and even for\n$n=2,\\dots,k+1$.\n\nFor $n > k+1$, group the  $k$-limited involutions into classes based on\ntheir actions on $k+2,\\dots,n$. Note that for $C$ a class and $\\sigma \\in C$,\nthe set of elements of $A = \\{1,\\dots,k+1\\}$ which map into $A$ under\n$\\sigma$ depends only on $C$, not on $\\sigma$. Call this set $S(C)$; then\nthe size of $C$ is exactly the number of involutions of $S(C)$.\nConsequently, $|C|$ is even unless $S(C)$ has at most one element.\nHowever, the element 1 cannot map out of $A$ because we are looking at\n$k$-limited involutions. Hence if $S(C)$ has one element and $\\sigma \\in C$,\nwe must have $\\sigma(1) = 1$. Since $\\sigma$ is $k$-limited and\n$\\sigma(2)$ cannot belong to $A$, we must have $\\sigma(2) = k+2$. By\ninduction, for $i=3,\\dots,k+1$, we must have  $\\sigma(i) = k+i$.\n\nIf $n < 2k+1$, this shows that no class $C$ of odd cardinality can exist,\nso $F_{n,k}$ must be even. If $n \\geq 2k+1$, the classes of odd cardinality\nare in bijection with $k$-limited involutions of $\\{2k+2,\\dots,n\\}$,\nso $F_{n,k}$ has the same parity as $F_{n-2k-1,k}$. By induction on $n$,\nwe deduce the desired result.\n\n\\textbf{Second solution:}\n(by Yufei Zhao)\nLet $M_{n,k}$ be the $n \\times n$ matrix with\n\\[\n(M_{n,k})_{ij} = \\begin{cases} 1 & |i-j|\\leq k \\\\ 0 & \\mbox{otherwise.}\n\\end{cases}\n\\]\nWrite $\\det(M_{n,k})$ as the sum over permutations\n$\\sigma$ of $\\{1,\\dots,n\\}$ of\n$(M_{n,k})_{1 \\sigma(1)} \\cdots (M_{n,k})_{n \\sigma(n)}$\ntimes the signature of $\\sigma$. Then $\\sigma$ contributes $\\pm 1$\nto $\\det (M_{n,k})$ if $\\sigma$ is $k$-limited and 0 otherwise.\nWe conclude that\n\\[\n\\det(M_{n,k}) \\equiv F_{n,k} \\pmod{2}.\n\\]\nFor the rest of the solution, we interpret $M_{n,k}$ as a matrix\nover the field of two elements. We compute its determinant using\nlinear algebra modulo 2.\n\nWe first show that for $n \\geq 2k+1$,\n\\[\nF_{n,k} \\equiv F_{n-2k-1,k} \\pmod{2},\n\\]\nprovided that we interpret $F_{0,k} = 1$. We do this by\ncomputing $\\det(M_{n,k})$ using row and column operations.\nWe will verbally describe these operations for general $k$,\nwhile illustrating with the example $k=3$.\n\nTo begin with, $M_{n,k}$ has the following form.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 1 & 1 & 1 & 0 & 0 & 0 & \\emptyset \\\\\n1 & 1 & 1 & 1 & 1 & 0 & 0 & \\emptyset \\\\\n1 & 1 & 1 & 1 & 1 & 1 & 0 & \\emptyset \\\\\n1 & 1 & 1 & 1 & 1 & 1 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 0 & 1 & 1 & 1 & 1 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & ? & ? & ? & *\n\\end{array}\n\\right)\n\\]\nIn this presentation, the first $2k+1$ rows and columns are shown\nexplicitly; the remaining rows and columns are shown in a compressed format.\nThe symbol $\\emptyset$ indicates that the unseen entries are all zeroes,\nwhile the symbol $?$ indicates that they are not. The symbol $*$ in the\nlower right corner represents the matrix $F_{n-2k-1,k}$.\nWe will preserve the unseen structure of the matrix by only adding\nthe first $k+1$ rows or columns to any of the others.\n\nWe first add row 1 to each of rows $2, \\dots, k+1$.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 1 & 1 & 1 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 1 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 0 & 1 & 1 & 1 & 1 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & ? & ? & ? & *\n\\end{array}\n\\right)\n\\]\nWe next add column 1 to each of columns $2, \\dots, k+1$.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 0 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 1 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 1 & 1 & 1 & 1 & 1 & ? \\\\\n0 & 0 & 0 & 1 & 1 & 1 & 1 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & ? & ? & ? & *\n\\end{array}\n\\right)\n\\]\nFor $i=2$, for each of $j=i+1,\\dots,2k+1$\nfor which the $(j, k+i)$-entry is nonzero,\nadd row $i$ to row $j$.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 0 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 1 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 0 & 1 & 1 & ? \\\\\n0 & 0 & 1 & 1 & 0 & 1 & 1 & ? \\\\\n0 & 0 & 0 & 1 & 0 & 1 & 1 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & ? & ? & *\n\\end{array}\n\\right)\n\\]\nRepeat the previous step for $i=3,\\dots,k+1$ in succession.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 0 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 1 & \\emptyset \\\\\n0 & 1 & 1 & 1 & 0 & 0 & 0 & ? \\\\\n0 & 0 & 1 & 1 & 0 & 0 & 0 & ? \\\\\n0 & 0 & 0 & 1 & 0 & 0 & 0 & ? \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & *\n\\end{array}\n\\right)\n\\]\nRepeat the two previous steps with the roles of the rows and columns reversed.\nThat is, for $i=2,\\dots,k+1$,\nfor each of $j=i+1,\\dots,2k+1$\nfor which the $(j, k+i)$-entry is nonzero,\nadd row $i$ to row $j$.\n\\[\n\\left(\n\\begin{array}{ccccccc|c}\n1 & 0 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 1 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 1 & \\emptyset \\\\\n0 & 1 & 0 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 1 & 0 & 0 & 0 & 0 & \\emptyset \\\\\n0 & 0 & 0 & 1 & 0 & 0 & 0 & \\emptyset \\\\\n\\hline\n\\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & \\emptyset & *\n\\end{array}\n\\right)\n\\]\nWe now have a block diagonal matrix in which the top left\nblock is a $(2k+1) \\times (2k+1)$ matrix with nonzero determinant (it\nresults from reordering the rows of the identity matrix), the bottom right\nblock is $M_{n-2k-1,k}$, and the other two blocks are zero. We conclude that\n\\[\n\\det(M_{n,k}) \\equiv \\det(M_{n-2k-1,k})\n\\pmod{2},\n\\]\nproving the desired congruence.\n\nTo prove the desired result, we must now check that\n$F_{0,k}, F_{1,k}$ are odd and $F_{2,k}, \\dots, F_{2k,k}$ are even.\nFor $n=0,\\dots,k+1$, the matrix $M_{n,k}$ consists of all ones,\nso its determinant is 1 if $n=0,1$ and 0 otherwise.\n(Alternatively, we have $F_{n,k} = n!$ for $n=0,\\dots,k+1$,\nsince every permutation of $\\{1,\\dots,n\\}$ is $k$-limited.)\nFor $n=k+2,\\dots,2k$,\nobserve that rows $k$ and $k+1$ of $M_{n,k}$  both consist of all ones,\nso $\\det(M_{n,k}) = 0$ as desired.\n\n\\textbf{Third solution:} (by Tom Belulovich)\nDefine $M_{n,k}$ as in the second solution. We prove\n$\\det(M_{n,k})$ is odd for $n \\equiv 0,1 \\pmod{2k+1}$ and even otherwise,\nby directly determining whether or not $M_{n,k}$ is invertible as a matrix\nover the field of two elements.\n\nLet $r_i$ denote row $i$ of $M_{n,k}$.\nWe first check that if $n \\equiv 2, \\dots, 2k \\pmod{2k+1}$, then $M_{n,k}$\nis not invertible. In this case, we can find integers $0 \\leq a < b \\leq k$\nsuch that $n + a + b \\equiv 0 \\pmod{2k+1}$.\nPut $j = (n+a+b)/(2k+1)$. We can then write the\nall-ones vector both as\n\\[\n\\sum_{i=0}^{j-1} r_{k+1-a + (2k+1)i}\n\\]\nand as\n\\[\n\\sum_{i=0}^{j-1} r_{k+1-b + (2k+1)i}.\n\\]\nHence $M_{n,k}$ is not invertible.\n\nWe next check that if $n \\equiv 0,1 \\pmod{2k+1}$, then $M_{n,k}$\nis invertible. Suppose that $a_1,\\dots,a_n$ are scalars such that\n$a_1 r_1 + \\cdots + a_n r_n$ is the zero vector. The $m$-th coordinate\nof this vector equals $a_{m-k} + \\cdots + a_{m+k}$, where we regard\n$a_i$ as zero if $i \\notin \\{1,\\dots,n\\}$. By comparing consecutive\ncoordinates, we obtain\n\\[\na_{m-k} = a_{m+k+1} \\qquad (1 \\leq m < n).\n\\]\nIn particular, the $a_i$ repeat with period $2k+1$.\nTaking $m=1,\\dots,k$ further yields that\n\\[\na_{k+2} = \\cdots = a_{2k+1} = 0\n\\]\nwhile taking $m=n-k, \\dots,n-1$ yields\n\\[\na_{n-2k} =  \\dots = a_{n-1-k} = 0.\n\\]\nFor $n \\equiv 0 \\pmod{2k+1}$, the latter can be rewritten as\n\\[\na_1 = \\cdots = a_k = 0\n\\]\nwhereas for $n \\equiv 1 \\pmod{2k+1}$, it can be rewritten as\n\\[\na_2 = \\cdots = a_{k+1} = 0.\n\\]\nIn either case, since we also have\n\\[\na_1 + \\cdots + a_{2k+1} = 0\n\\]\nfrom the $(k+1)$-st coordinate, we deduce that all of the $a_i$ must be\nzero, and so $M_{n,k}$ must be invertible.\n\n\n\\textbf{Remark:}\nThe matrices $M_{n,k}$ are examples of \\emph{banded matrices},\nwhich occur frequently in numerical applications of linear algebra.\nThey are also examples of \\emph{Toeplitz matrices}."
    }
  ]
}